<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GM Dashboard - Qail Collective</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
    @font-face {
      font-family: 'Englibesh';
      src: url("{{ url_for('static', filename='fonts/Englibesh.ttf') }}") format("truetype");
    }
  </style>
</head>
<body class="starwars-bg">

    <div class="topbar">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="Qail Collective" class="logo-small">
        <span class="welcome">Game Master Dashboard</span>
        <a id="logout" href="{{ url_for('logout') }}">Logout</a>
    </div>

    <div class="content">
        <h1>GM Dashboard</h1>

        {% for chat_name, chat in chats.items() %}
        <div class="chat-box">
            <h2>{{ chat_name }}</h2>
            <div class="messages">
                {% for m in chat["messages"] %}
                <p><strong>{{ m["from"] }}:</strong> {{ m["content"] }}</p>
                {% endfor %}
            </div>

            <!-- Reply as GM (with alias) -->
            <form method="POST" action="{{ url_for('gm_dashboard') }}">
                <input type="hidden" name="chat_name" value="{{ chat_name }}">

                <label for="from_name">Send as:</label>
                <input type="text" name="from_name" placeholder="e.g. NPC: Logistics" required>

                <label for="message">Message:</label>
                <input type="text" name="message" placeholder="Type your reply..." required>

                <button type="submit">Send</button>
            </form>
        </div>
        {% endfor %}

        <h2>Start a New Chat</h2>
        <form method="POST" action="{{ url_for('gm_dashboard') }}">
            <label for="recipient">Recipient:</label>
            <input type="text" name="recipient" id="recipient" required>

            <label for="new_chat_name">Chat Name:</label>
            <input type="text" name="new_chat_name" id="new_chat_name" required>

            <label for="from_name">Send as:</label>
            <input type="text" name="from_name" placeholder="e.g. Central Command" required>

            <label for="message">Message:</label>
            <input type="text" name="message" id="message" required>

            <button type="submit">Start Chat</button>
        </form>
    </div>

    <style>
        .chat-box {
          margin-bottom: 20px;
          padding: 15px;
          border: 1px solid #33ccff;
          border-radius: 6px;
          background: rgba(10, 20, 40, 0.85);
          box-shadow: 0 0 12px #33ccff;
        }

        .chat-box h2 {
          margin-bottom: 10px;
          color: #66e0ff;
          text-shadow: 0 0 6px #33ccff;
        }

        .messages {
          margin-bottom: 10px;
          padding: 10px;
          background: #0b1e33;
          border-radius: 4px;
          max-height: 200px;
          overflow-y: auto;
          font-family: monospace;
        }

        form {
          margin-top: 5px;
        }

        input[type="text"] {
          width: 70%;
          padding: 6px;
          background: #0b1e33;
          color: #e0f7ff;
          border: 1px solid #33ccff;
          border-radius: 4px;
        }

        button {
          background-color: #112244;
          color: #e0f7ff;
          border: 1px solid #33ccff;
          padding: 6px 12px;
          cursor: pointer;
          border-radius: 4px;
        }

        button:hover {
          background-color: #224466;
        }
        </style>

    </body>
</html>